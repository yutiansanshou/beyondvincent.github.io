
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>破船之家</title>
	<meta name="author" content="破船(BeyondVincent)">

	
	<meta name="description" content="Jun 1st, 2013 Step by Step, Windows商店应用开发 Windows Store App开发[004]弹出画面(Flayouts) 有时候在程序中，我们需要弹出一个画面与用户进行交互，此时我们并不想从当前画面切走，那是针对这种情况使用弹出画面(Flayouts) &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="破船之家" type="application/atom+xml">
	
	<link rel="canonical" href="http://BeyondVincent.github.io/blog/page/12/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		document.write("<img src='http://www.gravatar.com/avatar/" + MD5("beyondvincent@gmail.com") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
	</script>
</div>
<h1><a href="/">破船之家</a></h1>
<p class="subtitle">宠辱不惊，闲看庭前花开花落<br>去留无意，漫随天外云卷云舒<br>不妄取，不妄予，不妄想，不妄求<br>与人方便，随遇而安</p>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">首页</a></li>
  <li><a href="/blog/archives">所有文章</a></li>
  <li><a href="/about">关于我</a></li>
</ul>
</nav>
欢迎关注我的微信公众账号<br>
<div align=center><img width="100" height="100" src="http://beyondvincent.com/images/2013/12/qrcode_bv.jpg"></div>
<nav id="sub-nav">
	<div class="social">
		
		<a class="weibo" href="http://www.weibo.com/beyondvincent" title="Weibo">Weibo</a>
		
		
		
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-06-01T00:00:00+08:00" data-updated="true" itemprop="datePublished">Jun 1<span>st</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/step-by-step/'>Step by Step</a>, <a class='category' href='/blog/categories/windowsshang-dian-ying-yong-kai-fa/'>Windows商店应用开发</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/06/01/31/" itemprop="url">Windows Store App开发[004]弹出画面(Flayouts)</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>有时候在程序中，我们需要弹出一个画面与用户进行交互，此时我们并不想从当前画面切走，那是针对这种情况使用弹出画面(Flayouts)是比较好的一种选择。今天我就带领大家一起学习一下如何在程序画面中弹出一个画面。主要功能实现：当用户点击AppBar中的某个按钮时，弹出一个画面，达到与用户交互的目的。</p>

<p>弹出画面是一个pop-up窗口，显示在被点击按钮附近，当用户点击或者触摸屏幕的非弹出画面区域时，弹出画面会自动的消失。</p>

<p>&#160;&#160;&#160; 通过本次学习，你将掌握以下内容：</p>

<p>1、创建自定义控件</p>

<p>2、编写自定义控件代码</p>

<p>3、定位弹出的控件（画面）</p>

<p>4、在程序中使用弹出画面</p>

<p>5、显示弹出画面</p>

<p>6、最后附上程序运行截图和程序demo</p>

<p>&#160;</p>

<p>1、创建自定义控件</p>

<p>&#160;&#160;&#160; 为了代码易于管理，在这里，我把弹出画面定义为一个自定义控件。也就是包含一个xaml文件和相关的代码文件。如下图所示，如何创建自定义控件：</p>

<p>选择用户控件，输入名称就可以了。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/12.png"><img title="1" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="1" src="http://beyondvincent.com/wp-content/uploads/2013/05/1_thumb1.png" width="682" height="433" /></a></p>

<p>下图是创建好的画面</p>

<p>我将控件文件SearchFlayout存放在Flayouts文件夹下</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/21.png"><img title="2" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="2" src="http://beyondvincent.com/wp-content/uploads/2013/06/2_thumb.png" width="682" height="410" /></a></p>

<p>在xaml文件中添加如下代码</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;usercontrol xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="using:DevDiv_AppBar.Flayouts" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" x:class="DevDiv_AppBar.Flayouts.SearchFlayout" mc:ignorable="d" d:designheight="300" d:designwidth="400"&gt;
    
    &lt;grid&gt;
        &lt;popup x:name="SearchPopup" islightdismissenabled="True" width="350" height="130"&gt;
            &lt;stackpanel background="Black"&gt;
                &lt;border background="#85bd" borderthickness="4"&gt;
                    &lt;stackpanel&gt;
                        &lt;stackpanel orientation="Horizontal" margin="10"&gt;
                            &lt;textblock margin="0,0,10,0" text="请输入搜索内容:" verticalalignment="Center"&gt;&lt;/textblock&gt;
                            &lt;textbox width="150" height="40" name="searchDataBox" fontsize="20"&gt;&lt;/textbox&gt;
                        &lt;/stackpanel&gt;
                        &lt;button margin="10" click="SearchButtonClick" horizontalalignment="Center"&gt;搜索&lt;/button&gt;
                    &lt;/stackpanel&gt;
                &lt;/border&gt;
            &lt;/stackpanel&gt;
        &lt;/popup&gt;
    &lt;/grid&gt;
&lt;/usercontrol&gt;</pre>


<p>在代码中，需要提醒的是Popup的属性IsLightDismissEnabled=&ldquo;True&#8221;。这表示当用户点击或者触摸屏幕的任意位置，不包括Popup的位置，pop-up画面是否消失。当把Popup用作弹出画面时，这个属性必须设置为True，因为这是才符合基本的弹出画面(flyout）用户体验。</p>

<p>如下图所示，我们还可以在设计器中，看到自定义控件长什么样</p>

<p>在上面的代码中需要注意的是创建弹出画面必须使用Popup控件，至于Popup控件里面的内容就按需而定即可。我在这里用了TextBlock、TextBox和Button三个控件，当然还有一个StackPanel容器控件。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/06/3.png"><img title="3" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="3" src="http://beyondvincent.com/wp-content/uploads/2013/06/3_thumb.png" width="682" height="524" /></a></p>

<p>这样我们xaml文件就基本写完了。下面我们开始编写控件的C#代码</p>

<p>2、编写自定义控件代码</p>

<p>在这里，自定义控件中主要实现两个功能：显示控件本身和响应控件提供的相关用户交互操作大家看下面两个函数Show方法主要就是将自己显示出来。SearchButtonClick是响应自定义控件中的搜索按钮事件。</p>

<p>注意：在Show方法中有一行代码如下，是用来计算当前弹出画面需要显示的位置，后面会有讲解（由于目前的版本中微软并没有提供相关好的方法来获取显示的位置，所以需要自行计算，希望在windows 8正式版发布之后，能解决这个问题）</p>

<p>FlyoutHelper.ShowRelativeToAppBar(SearchPopup, page, appbar, button);</p>

<pre class="wp-code-highlight prettyprint linenums:1">public void Show(Page page, AppBar appbar, Button button)
{
    SearchPopup.IsOpen = true;
        
    FlyoutHelper.ShowRelativeToAppBar(SearchPopup, page, appbar, button);
}</pre>




<pre class="wp-code-highlight prettyprint linenums:1">private void SearchButtonClick(object sender, RoutedEventArgs e) 
{
    SearchPopup.IsOpen = false;
}</pre>


<p>3、定位弹出的控件（画面）</p>

<p>在这里我创建了一个FlyoutHelper类，其中定义了一个静态方法ShowRelativeToAppBar。这个方法计算出相关按钮上显示的Popup的正确位置，这样做，需要传入Popup控件、包含AppBar的Page、AppBar控件和被点击的button按钮。这个方法并不好，但这是我发现的可以获得flyout准确位置的唯一方法。具体代码如下：</p>

<pre class="wp-code-highlight prettyprint linenums:1">namespace DevDiv_AppBar.Flayouts
{
    class FlyoutHelper
    {
        public static void ShowRelativeToAppBar(Popup popup, Page page, AppBar appbar, Button button)
        {
            Func&lt;uielement  , uielement, point&gt; getOffset = delegate(UIElement control1, UIElement control2)
            {
                return control1.TransformToVisual(control2).TransformPoint(new Point(0, 0));
            };

            Point popupOffset = getOffset(popup, page);
            Point buttonOffset = getOffset(button, page);
            popup.HorizontalOffset = buttonOffset.X - popupOffset.X - (popup.ActualWidth / 2) + (button.ActualWidth / 2); popup.VerticalOffset = getOffset(appbar, page).Y - popupOffset.Y - popup.ActualHeight;
            if (popupOffset.X + popup.HorizontalOffset + popup.ActualWidth &gt; page.ActualWidth)
            {
                popup.HorizontalOffset = page.ActualWidth - popupOffset.X - popup.ActualWidth;
            }
            else if
                (popup.HorizontalOffset + popupOffset.X &lt; 0)
            {
                popup.HorizontalOffset = -popupOffset.X;
            }
        }
    }
}</pre>


<p>代码会将Popup定位在与其相关的AppBar按钮的上方，如果Popup从屏幕的左侧或右侧消失那么Popup将被重新定位，由于这代码比较恶心，我就不细讲了，希望在windows 8正式版发布之后，这个问题会得到解决。</p>

<p>4、在程序中使用弹出画面</p>

<p>将刚刚定义的控件添加到MainPage.xaml中,代码如下所示。</p>

<p>这里需要将名称空间添加进来using:DevDiv_AppBar.Flayouts 这样才能使用Flayouts中定义的控件。</p>

<p>下面的代码中，添加自定义控件是这行代码</p>

<p>&lt;flyouts:SearchFlayout x:Name=&ldquo;SearchFlayout&rdquo;/></p>

<p>虽然这里并不是马上就显示出弹出画面，但是我们也需要把自定义控件声明为主程序布局的一部分。</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:local="using:DevDiv_AppBar" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" x:class="DevDiv_AppBar.MainPage" mc:ignorable="d" xmlns:flyouts="using:DevDiv_AppBar.Flayouts" istabstop="false"&gt;
    

    &lt;grid background="PaleGoldenrod"&gt;
        &lt;img width="295" height="200" margin="495,215,0,0" verticalalignment="Top" horizontalalignment="Left" source="Assets/icon.png" /&gt;
        &lt;flyouts:searchflayout x:name="SearchFlayout" /&gt;
    &lt;/grid&gt;
&lt;/page&gt;</pre>


<p>5、显示弹出画面</p>

<p>现在代码基本编写完毕了，剩下的任务就是当用户点击AppBar上的搜索按钮时，将弹出画面显示出来即可。</p>

<p>我在MainPage.xaml.cs中添加如下代码：</p>

<p>并将该方法与AppBar的搜索按钮Click事件关联起来即可</p>

<pre class="wp-code-highlight prettyprint linenums:1">private void AppBarButtonClick(object sender, RoutedEventArgs e){
    if (e.OriginalSource == AppBarSearchButton)
    {
        SearchFlayout.Show(this, this.BottomAppBar, (Button)e.OriginalSource);
    }
}</pre>


<p>6、最后附上程序运行截图和程序demo</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/06/4.png"><img title="4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="4" src="http://beyondvincent.com/wp-content/uploads/2013/06/4_thumb.png" width="682" height="386" /></a></p>

<p>代码下载</p>

<p><a href="https://github.com/BeyondVincent/WindowsStoreAppStepByStep/tree/master/Flayouts" target="_blank"><img src="http://beyondvincent.com/wp-content/uploads/2013/05/code_xaml.png" /></a></p>

<p>&#160;</p>

<div style="text-align: left">
  <span style="color: #339966"></span>
</div>




<div style="text-align: left">
  <span style="color: #339966">本文由<span style="text-decoration: underline"><a href="http://beyondvincent.com/"><span style="color: #339966; text-decoration: underline">破船</span></a></span>原创●转载请注明出处●<time data-updated="true" datetime="2013-05-18T17:37:00+08:00">2012-05-31</time></span>
</div>




		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-31T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 31<span>st</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ios/'>iOS</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/31/30/" itemprop="url">Xcode Code Snippets</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/fend_off_rsi.jpg"><img class="alignnone size-full wp-image-734" alt="fend_off_rsi" src="http://beyondvincent.com/wp-content/uploads/2013/05/fend_off_rsi.jpg" width="1200" height="620" /></a></p>

<p>在Double Encore，我们写的代码都是干净，可重用的——不过，有时候并不能完全做到。如在使用pragma mark的时候。下面就是一个示例：</p>

<pre class="wp-code-highlight prettyprint linenums:1">#pragma mark - UIViewController overrides</pre>


<p>通过pragma mark，可以让代码看起来既整洁又有组织。虽然这很重要，但是会带来额外的输入操作和时间。</p>

<p>此时，我们可以使用code snippets。</p>

<p>通过code snippets，我们可以创建一些可重用的代码块，并且在任何需要的地方很容易的就可以使用这些代码块。这可以节省输入需要的操作和时间。并且，一旦你学会使用code snippets，会发现你可以创建并扩充自己的code snippet library。</p>

<p>创建一个code snippet非常简单。首先，打开Xcode并在utilities panel中选择code snippet library。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/1-1024x768.png"><img class="alignnone size-full wp-image-736" alt="1-1024x768" src="http://beyondvincent.com/wp-content/uploads/2013/05/1-1024x768.png" width="1024" height="768" /></a></p>

<p>上图中，可以看到在code snippet library中已经有一些数据了。</p>

<p>接着，输入希望创建的code snippet。在这里，我为pragma mark创建一个code snippet。如下图所示，在代码编辑器中输入 “#pragma mark – UIViewController overrides”。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/2-1024x768.png" width="1024" height="768" /></p>

<p>选中代码块，如下图所示：</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/3-1024x768.png" width="1024" height="768" /></p>

<p>然后单击并按住代码块，知道文本光标变为箭头光标。接着将代码块拖放到code snippet library中，然后松开鼠标。如下图所示</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/4-1024x768.png" width="1024" height="768" /></p>

<p>此时会弹出一个popover，通过该popover可以对新的code snippet进行编辑，如下图所示。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/5-1024x768.png" width="1024" height="768" /></p>

<p>首先，是定snippet的名字。这里我指定为“Pragma Mark”</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/6-1024x768.png" width="1024" height="768" /></p>

<p>然后，指定该snippet的completion shortcut（可选项）。这里我指定为“pm”。这样设置以后，在Xcode的代码编辑器中只需要输入快捷方式（pm），就能简单的将这个snippet添加到代码中。非常有用！</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/7-1024x768.png" width="1024" height="768" /></p>

<p>接着，可以看到在上面的示例中，pragma mark的标题是“UIViewController overrides”，不过我们是希望对其修改一下，以能够很容易的输入任意标题。</p>

<p>我们可以简单的将code snippet包含的文本内容修改为“#pragma mark – “即可。不过，这里还有更好的一个办法——将文本块封装到“&lt;#” 和 “#>”中间，这样code snippet将指出我们可以插入自定义文本的完整范围。</p>

<p>下面，将“UIViewController overrides”替换…</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/8-1024x768.png" width="1024" height="768" /></p>

<p>&#8230;为“&lt;#Title#>”。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/9-1024x768.png" width="1024" height="768" /></p>

<p>注意，completion scopes字段在这里并没有做修改，通过该字段可以指定completion shortcut的有效范围。</p>

<p>最后，点击edit按钮，以完成snippet的编辑。之后可以在这个popover画面中看到最终结果的一个预览效果。</p>

<p>&nbsp;</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/10-1024x768.png" width="1024" height="768" /></p>

<p>然后点击popover中的done按钮。下面，你可以将我们在代码编辑器中为创建snippet而写入的文本行删除掉。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/11-1024x768.png" width="1024" height="768" /></p>

<p>现在来试用一下刚刚创建的snippet！有两种方法。第一种是在code snippet library中找到snippet，然后用鼠标将其拖拽到代码编辑器中&#8230;</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/12-1024x768.png" width="1024" height="768" /></p>

<p>&#8230;然后松开鼠标。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/13-1024x768.png" width="1024" height="768" /></p>

<p>一旦将snippet拖放到代码编辑器之后，就可以通过点击键盘上的tab键在不同的completion字段间移动焦点。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/14-1024x768.png" width="1024" height="768" /></p>

<p>第二种方法是在代码编辑器里简单的输入completion shortcut中设置的内容即可。我们这里是“pm”。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/15-1024x768.png" width="1024" height="768" /></p>

<p>然后点击键盘中的return键，就可以将snippet插入到代码编辑器中。</p>

<p><img class="alignnone size-full wp-image-736" alt="" src="http://www.doubleencore.com/wp-content/uploads/2013/04/141-1024x768.png" width="1024" height="768" /></p>

<p>很简单吧！现在你已经知道如何创建自己的snippet了，你将发现这非常的有用。任何时候，你都遇到重复输入的相同代码块，都可以考虑将其添加到你的code snippets library中。</p>

<p>&nbsp;</p>

<p>下面是我经常使用到的一些snippet：</p>

<pre class="wp-code-highlight prettyprint linenums:1">Title: Animation Block
Completion Shortcut: ab
Completion Scopes: Function or Method
 
void (^&lt;#Title#&gt;)(void) = ^{ };
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: Animation Completion Block
Completion Shortcut: acb
Completion Scopes: Function or Method
 
void (^&lt;#Title#&gt;)(BOOL) = ^(BOOL finished) { };
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: Notification Add
Completion Shortcut: na
Completion Scopes: Function or Method
 
[[NSNotificationCenter defaultCenter] addObserver:&lt;#Observer#&gt; selector:&lt;#Selector#&gt; name:&lt;#Name#&gt; object:&lt;#Object#&gt;];
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: Notification Remove
Completion Shortcut: nr
Completion Scopes: Function or Method
 
[[NSNotificationCenter defaultCenter] removeObserver:&lt;#Observer#&gt; name:&lt;#Name#&gt; object:&lt;#Object#&gt;];
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: NSLog
Completion Shortcut: log
Completion Scopes: Function or Method
 
NSLog(@"&lt;#Log#&gt;");
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: Private Interface
Completion Shortcut: pi
Completion Scopes: Top Level
 
@interface &lt;#Title#&gt; ()

@end
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: Property Assign
Completion Shortcut: pa
Completion Scopes: All
 
@property (assign, nonatomic)
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: Property Strong
Completion Shortcut: ps
Completion Scopes: All
 
@property (strong, nonatomic)
</pre>




<pre class="wp-code-highlight prettyprint linenums:1">Title: Property Unsafe Unretained
Completion Shortcut: pu
Completion Scopes: All
 
@property (unsafe_unretained, nonatomic)
</pre>




<div style="text-align: left;">
</div>




<div style="text-align: left;">
</div>




<div style="text-align: left;">
  <span style="color: #808080;">本文由<span style="text-decoration: underline; color: #339966;"><a href="http://beyondvincent.com/"><span style="color: #339966; text-decoration: underline;">破船</span></a></span>译自<span style="text-decoration: underline; color: #339966;"><a href="http://www.doubleencore.com/2013/05/xcode-code-snippets/" target="_blank"><span style="color: #339966; text-decoration: underline;">doubleencore</span></a></span>●转载请注明出处●<time datetime="2013-05-18T17:37:00+08:00" data-updated="true">2012-05-30</time></span>
</div>




		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-31T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 31<span>st</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/step-by-step/'>Step by Step</a>, <a class='category' href='/blog/categories/windowsshang-dian-ying-yong-kai-fa/'>Windows商店应用开发</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/31/29/" itemprop="url">Windows Store App开发[003]应用程序栏(AppBar)的使用</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>今天我们来学习一下Windows 8 AppBar的使用。本次主题会包含以下内容：</p>

<p><strong>1、Windows 8 AppBar介绍</strong></p>

<p><strong>2、Windows 8 AppBar定义[预定义和自定义按钮风格的使用]</strong></p>

<p><strong>3、AppBar中按钮事件的处理</strong></p>

<p><strong>4、Demo演示与代码下载</strong></p>

<p>&#160;</p>

<p><strong>1、Windows 8 AppBar介绍</strong></p>

<p>&#160;&#160;&#160; 在Windows 8设备上，当用户做一个向上滑动的手势或者点击鼠标右键，应用程序栏(AppBar)会出现在屏幕的底部，Metro Ui强调在主布局中尽量少出现控件，主要依托AppBar进行交互。如下图所示，就是开始程序的AppBar。</p>

<p>&#160;&#160;&#160; 注意，在这里体现了Metro App UI设计风格：选中项对应的操作按钮放在AppBar的左边，其它的按钮则放在右边。</p>

<p>&#160;&#160;&#160; 如下图，我选中了Video程序。左边出现了对应的从“开始”屏幕取消固定，卸载，缩小，右边则是所有应用。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/1.png"><img title="1" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="1" src="http://beyondvincent.com/wp-content/uploads/2013/05/1_thumb.png" width="682" height="428" /></a></p>

<p>&#160;</p>

<p>提示：在屏幕的顶部也有相似的控件——导航栏(NavBar)，用于Metro程序中不同画面的导航。在后面的学习系列中，我会进行介绍。</p>

<p><strong>2、Windows 8 AppBar定义[预定义和自定义按钮风格的使用]</strong></p>

<p>创建AppBar最简单的方法就是在XAML文件中声明AppBar。在这里我使用Blank App模版创建了一个程序，如下图：</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/2.png"><img title="2" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="2" src="http://beyondvincent.com/wp-content/uploads/2013/05/2_thumb.png" width="682" height="433" /></a>
&#160;</p>

<p>在其中的MainPage.xaml中，我添加了如下代码</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/3.png"><img title="3" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="3" src="http://beyondvincent.com/wp-content/uploads/2013/05/3_thumb.png" width="300" height="246" /></a></p>

<p>代码添加在</Grid>之后</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;grid background="PaleGoldenrod"&gt;

&lt;/grid&gt;
&lt;page.bottomappbar&gt;
    &lt;appbar&gt;
        &lt;grid width="1346" background="Firebrick" horizontalalignment="Left"&gt;
            &lt;grid.columndefinitions&gt;
                &lt;columndefinition width="425*"&gt;
                &lt;/columndefinition&gt;
                &lt;columndefinition width="248*" /&gt;
            &lt;/grid.columndefinitions&gt;
            &lt;stackpanel grid.column="0" horizontalalignment="Left" orientation="Horizontal"&gt;
                &lt;button x:name="AppBarSearchButton" click="AppBarButtonClick" automationproperties.name="搜索"&gt;
                &lt;button x:name="AppBarMoreButton" click="AppBarButtonClick" automationproperties.name="更多"&gt;
            &lt;/stackpanel&gt;
            &lt;stackpanel grid.column="1" horizontalalignment="Right" orientation="Horizontal"&gt;
                &lt;button x:name="AppBarHomeButton" click="AppBarButtonClick"&gt;
            &lt;/stackpanel&gt;
        &lt;/grid&gt;
    &lt;/appbar&gt;
&lt;/page.bottomappbar&gt;
&lt;pre&gt;</pre>




<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>


<p></button></p>

<p>&#160;&#160;&#160; 从上面的代码中，看出，我在Page.BottomAppBar属性中声明了AppBar控件。也就是说，通过上面的代码，创建了一个AppBar和相关内容，并把AppBar赋值给了MainPage页面的BottomAppBar属性。</p>

<p>提示：在Page.TopAppBar属性里面可以通过声明AppBar来创建NavBar，当然，在后面的学习系列中，我会详细讲解。</p>

<p>为了遵循Metro App Ui关于 AppBar的设计准则，我在AppBar控件里面添加了一个一行两列的网格(Grid),每列包含一个栈面板(StackPanel)。</p>

<p>&#160;&#160;&#160; 下面我们来看看栈面板里面的内容，也就是按钮的添加。按钮的风格添加有两种方法，这里我会进行使用讲解。</p>

<p>第一种方法：我在第一个栈面板中定义的两个按钮搜索和更多。他们使用了StandardStyles.xaml里面系统提供的风格。StandardStyles.xaml为我们的程序提供了许多风格，如下是定义了搜索按钮的风格：</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;style x:key="SearchAppBarButtonStyle" targettype="Button" basedon="{StaticResource AppBarButtonStyle}"&gt;
    &lt;setter property="AutomationProperties.AutomationId" value="SearchAppBarButton"/&gt;
    &lt;setter property="AutomationProperties.Name" value="Search"/&gt;
    &lt;setter property="Content" value=""/&gt;
&lt;/style&gt;</pre>


<p>所有这些预定义的按钮风格都是继承自 AppBarButtonStyle，AppBarButtonStyle 定义了AppBar按钮的基本特征。在下一节中创建自定义按钮也会继承自这个风格。提示：在文件 StandardStyles.xaml 中已经定义了 29 中应用程序按钮风格，但是来自 XAML小组的微软项目经理提供了非正式的替代文件，该文件定义了 150 种不同的风格。该文件可以在下面的连接中看到：</p>

<p><a href="http://timheuer.com/blog/archive/2012/03/05/visualizing-appbar-command-styles-windows-8.aspx">XAML AppBar Button Styles for Windows 8</a></p>

<p>区分不同按钮的两个属性是 AutomationProperties.Name 和 Content。</p>

<p>AutomationProperties.Name 属性指定了按钮显示的文本</p>

<p>Content 属性指定会被用到的 icon。这个属性(Content)的值来自 Segoe UI Symbol 字体的编码。可以通过 Windows 8 提供的字符表(Character Map)工具来查看这种字体定义的 icon。值 E10B对应的是一个勾号。</p>

<p>下面的代码给出了AppBar使用预定义的SearchAppBarButtonStyle风格：</p>

<p>[注：在StandardStyles.xaml文件定义的Name是Search，为了显示中文，我在这里修改为了搜索]</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;button x:name="AppBarSearchButton" click="AppBarButtonClick" automationproperties.name="搜索"&gt;
&lt;pre&gt;</pre>


<p></p></p>

<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>


<p></button></p>

<p>第二种方法：使用自定义的风格。</p>

<p>我在工程中添加了一个文件夹：Resources，并添加了一个字典资源文件：MyDictionary.xaml，如下图所示</p>

<p>&#160;</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/4.png"><img title="4" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="4" src="http://beyondvincent.com/wp-content/uploads/2013/05/4_thumb.png" width="682" height="433" /></a></p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/5.png"><img title="5" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="5" src="http://beyondvincent.com/wp-content/uploads/2013/05/5_thumb.png" width="327" height="316" /></a></p>

<p>在MyDictionary.xaml文件中，我定义了DoneAppBarButtonStyle风格，代码如下所示：</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;resourcedictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:local="using:DevDiv_AppBar.Resources" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"&gt;
    
&lt;resourcedictionary.mergeddictionaries&gt;
        &lt;resourcedictionary source="/Common/StandardStyles.xaml"&gt;&lt;/resourcedictionary&gt;
    &lt;/resourcedictionary.mergeddictionaries&gt;
    
&lt;style x:key="DoneAppBarButtonStyle" targettype="Button" basedon="{StaticResource AppBarButtonStyle}"&gt;
        &lt;setter property="AutomationProperties.Name" value="完成"/&gt;
        &lt;setter property="Content" value=""/&gt;
    &lt;/style&gt;
    
&lt;/resourcedictionary&gt;</pre>


<p>这里有个小插曲，代码中需要添加如下代码，才能够正确运行，否则运行时会出错。[为什么还不太清楚，高手来过招吧][搞明白了，原来DoneAppBarButtonStyle里面有BasedOn=&ldquo;{StaticResource AppBarButtonStyle}&rdquo; ，就是说DoneAppBarButtonStyle 继承自AppBarButtonStyle ，AppBarButtonStyle&#160; 定义了AppBar按钮的默认风格。破船@2012/07/26</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;resourcedictionary.mergeddictionaries&gt;
        &lt;resourcedictionary source="/Common/StandardStyles.xaml" /&gt;
    &lt;/resourcedictionary.mergeddictionaries&gt;</pre>


<p>定义了字典文件之后，还需要在App.xaml文件中把该字典文件关联起来，也就是还需要在App.xaml文件中添加如下代码</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;resourcedictionary source="Resources/MyDictionary.xaml" /&gt;</pre>


<p>到这里，我们的AppBar风格自定义就完成了，我们只需要在使用到的地方如同使用系统预定义好的一样即可。如下代码在第二个栈面板中：</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;button x:name="AppBarHomeButton" click="AppBarButtonClick"&gt;&lt;pre&gt;</pre>


<p></p></p>

<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>




<div>
</div>


<p></button></p>

<p><strong>3、AppBar中按钮事件的处理</strong></p>

<p>至此，我们的控件已经添加完毕，但是还需要响应事件才行。细心的读者可能已经在帖子刚开始给出代码的地方看到这样的语句：</p>

<pre class="wp-code-highlight prettyprint linenums:1">Click=&quot;AppBarButtonClick&quot;</pre>


<p>没错，这就是通过xaml文件给按钮添加事件的处理方法。在这里声明之后，我们还需要到MainPage.xaml.cs文件中把AppBarButtonClick函数实现一下。如下代码，为了说明事件的处理，我只是简单的写了一个函数，并判断了一下发起者</p>

<pre class="wp-code-highlight prettyprint linenums:1">private void AppBarButtonClick(object sender, RoutedEventArgs e)
{
    if (e.OriginalSource == AppBarDoneButton)
    {
    }
}</pre>


<p>这样我们的程序代码就基本写完了。</p>

<p><strong>4、Demo演示与代码下载</strong></p>

<p>下面我运行一下程序，并把程序画面和代码附上，供大家参考。</p>

<p>大家可能看到颜色的不同，在这里我说明一下</p>

<p>在MainPage.xaml中有如下定义：</p>

<p>主布局：Grid Background =&ldquo;PaleGoldenrod&rdquo;</p>

<p>AppBar：Grid Background=&ldquo;Firebrick&rdquo;&#160;&#160; <br/>
相信你应该知道如何设置 Grid的颜色了</p>

<p>&#160;</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/6.png"><img title="6" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="6" src="http://beyondvincent.com/wp-content/uploads/2013/05/6_thumb.png" width="682" height="386" /></a></p>

<p>下载示例代码</p>

<p><a href="https://github.com/BeyondVincent/WindowsStoreAppStepByStep/tree/master/AppBar" target="_blank"><img src="http://beyondvincent.com/wp-content/uploads/2013/05/code_xaml.png" /></a></p>

<div style="text-align: left;">
  <span style="color: #339966;">本文由<span style="text-decoration: underline;"><a href="http://beyondvincent.com/"><span style="color: #339966; text-decoration: underline;">破船</span></a></span>原创●转载请注明出处●<time datetime="2013-05-18T17:37:00+08:00" data-updated="true">2012-05-31</time></span>
</div>




		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-31T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 31<span>st</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/step-by-step/'>Step by Step</a>, <a class='category' href='/blog/categories/windowsshang-dian-ying-yong-kai-fa/'>Windows商店应用开发</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/31/28/" itemprop="url">Windows Store App开发[002]开发环境搭建与HelloWorld</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p>今天我们展开Windows 8 Metro App开发之HelloWorld。本次主题会包含以下内容：</p>

<p>1、Windows 8 Metro App开发环境的搭建</p>

<p>2、HelloWorld创建与相关介绍</p>

<p>3、运行和调试</p>

<p>4、应用程序包的创建和安装（本地，不通过商店）</p>

<p>&#160;</p>

<p>1、Windows 8 Metro App开发环境的搭建</p>

<p>来下面的链接下载操作系统和VS <br/>
<a href="http://www.microsoft.com/china/livetocode/hackathon/learn8.html">http://msdn.microsoft.com/zh-CN/windows/apps/br229516</a></p>

<p>2、HelloWorld创建与相关介绍</p>

<p>为了更加形象直观，下面我以图文的形式进行介绍</p>

<p>a、从开始画面启动VS2012</p>

<p>&#160;</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/12.jpg"><img title="1" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="1" src="http://beyondvincent.com/wp-content/uploads/2013/05/1_thumb.jpg" width="682" height="410" /></a></p>

<p>&#160;</p>

<p>b、在起始页选项卡中，选择新建项目来创建HelloWorld，也可以从文件菜单->新建->项目来创建。</p>

<p>如下图，模版选择Visual C# Windows Metro style，右边选择Blank App(XAML)，然后在下面输入项目名称，路径和解决方案名称，最后点击确定，就创建好了一个最简单的Metro App。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/22.jpg"><img title="2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="2" src="http://beyondvincent.com/wp-content/uploads/2013/05/2_thumb.jpg" width="682" height="433" /></a></p>

<p>&#160;</p>

<p>c、创建好的HelloWorld工程如下图，熟悉VS的开发者可能对此画面不陌生，左边主要是代码编辑，右边三项目文件目录组织。当然，这些界面也是可以配置的。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/32.jpg"><img title="3" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="3" src="http://beyondvincent.com/wp-content/uploads/2013/05/3_thumb.jpg" width="682" height="410" /></a></p>

<p>&#160;</p>

<p>d、右侧，我们可以看到工程的文件组织，如下图所示，下面我会对其中的重要文件进行介绍。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/42.jpg"><img title="4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="4" src="http://beyondvincent.com/wp-content/uploads/2013/05/4_thumb.jpg" width="359" height="384" /></a></p>

<p>&#160;</p>

<p>从上图中，可以看到有如下文件和目录：</p>

<p>1)Properties</p>

<p>2)引用</p>

<p>3)Assets</p>

<p>4)Common</p>

<p>5)App.xaml</p>

<p>6)MainPage.xaml</p>

<p>7)Package.appemanifest</p>

<p>&#160;</p>

<p>1)Properties目录下的文件Assembly.cs主要存放有关程序集的常规信息和程序的版本信息</p>

<pre class="wp-code-highlight prettyprint linenums:1">using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// 有关程序集的常规信息通过下列特性集
// 控制。更改这些特性值可修改
// 与程序集关联的信息。
[assembly: AssemblyTitle(&quot;DevDiv_HelloWorld&quot;)]
[assembly: AssemblyDescription(&quot;&quot;)]
[assembly: AssemblyConfiguration(&quot;&quot;)]
[assembly: AssemblyCompany(&quot;&quot;)]
[assembly: AssemblyProduct(&quot;DevDiv_HelloWorld&quot;)]
[assembly: AssemblyCopyright(&quot;Copyright ©  2012&quot;)]
[assembly: AssemblyTrademark(&quot;&quot;)]
[assembly: AssemblyCulture(&quot;&quot;)]

// 程序集的版本信息由下面四个值组成:
//
//      主版本
//      次版本
//      生成号
//      修订号
//
// 可以指定所有这些值，也可以使用“生成号”和“修订号”的默认值，
// 方法是按如下所示使用“*”:
// [assembly: AssemblyVersion(&quot;1.0.*&quot;)]
[assembly: AssemblyVersion(&quot;1.0.0.0&quot;)]
[assembly: AssemblyFileVersion(&quot;1.0.0.0&quot;)]
[assembly: ComVisible(false)]</pre>


<p>2)引用，从上面的图中，我们看到默认有两个引用：.NET for Metro style apps和Windows</p>

<p>Metro 应用使用简装版的.NET框架库。我们可以双击Reference查看看到他们对应的命名空间。</p>

<p>3)Assets，该目录下主要存放程序使用到的Logo，启动画面等信息。</p>

<p>4)Common里面有一个文件：</p>

<p>StandardStyles.xaml，它是一个资源文件，它与App.xaml文件进行关联的。其中包含了一些Style和Template，通过这个文件，我们创建应用会变得更容易。</p>

<p>下面我分别摘取了一个Style和Template。</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;style x:key="BasicRichTextStyle" targettype="RichTextBlock"&gt;
    &lt;setter property="Foreground" value="{StaticResource ApplicationForegroundThemeBrush}"/&gt;
    &lt;setter property="FontSize" value="{StaticResource ControlContentThemeFontSize}"/&gt;
    &lt;setter property="FontFamily" value="{StaticResource ContentControlThemeFontFamily}"/&gt;
    &lt;setter property="TextTrimming" value="WordEllipsis"/&gt;
    &lt;setter property="TextWrapping" value="Wrap"/&gt;
    &lt;setter property="Typography.StylisticSet20" value="True"/&gt;
    &lt;setter property="Typography.DiscretionaryLigatures" value="True"/&gt;
    &lt;setter property="Typography.CaseSensitiveForms" value="True"/&gt;
&lt;/style&gt;</pre>




<pre class="wp-code-highlight prettyprint linenums:1">&lt;datatemplate x:key="Standard130ItemTemplate"&gt;
    &lt;grid height="110" margin="6"&gt;
        &lt;grid.columndefinitions&gt;
            &lt;columndefinition width="Auto" /&gt;
            &lt;columndefinition width="*" /&gt;
        &lt;/grid.columndefinitions&gt;
        &lt;border height="110" width="110" background="{StaticResource ListViewItemPlaceholderBackgroundThemeBrush}"&gt;
            &lt;img source="{Binding Image}" stretch="UniformToFill" /&gt;
        &lt;/border&gt;
        &lt;stackpanel margin="10,0,0,0" grid.column="1" verticalalignment="Top"&gt;
            &lt;textblock text="{Binding Title}" textwrapping="NoWrap" /&gt;
            &lt;textblock text="{Binding Subtitle}" textwrapping="NoWrap" /&gt;
            &lt;textblock text="{Binding Description}" maxheight="60" /&gt;
        &lt;/stackpanel&gt;
    &lt;/grid&gt;
&lt;/datatemplate&gt;</pre>


<p>5)App.axml</p>

<p>App.xaml 文件和它对应的代码文件是 App.xaml.cs，用于启动 Metro App。这个 XAML 文件的主要用途是与 Common 文件夹中的StandardStyles.xaml进行关联。如下代码所示</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;application xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:local="using:DevDiv_HelloWorld" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" x:class="DevDiv_HelloWorld.App"&gt;

    &lt;application.resources&gt;
        &lt;resourcedictionary&gt;
            &lt;resourcedictionary.mergeddictionaries&gt;

                &lt;!-- 
                    Styles that define common aspects of the platform look and feel
                    Required by Visual Studio project and item templates
                 --&gt;
                &lt;resourcedictionary source="Common/StandardStyles.xaml"&gt;&lt;/resourcedictionary&gt;
            &lt;/resourcedictionary.mergeddictionaries&gt;

        &lt;/resourcedictionary&gt;
    &lt;/application.resources&gt;
&lt;/application&gt;</pre>


<p>下面我们来看看 App.xaml.cs文件中的代码</p>

<p>方便阅读，我们其中的注视去掉了。</p>

<pre class="wp-code-highlight prettyprint linenums:1">using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Windows.ApplicationModel;
using Windows.ApplicationModel.Activation;
using Windows.Foundation;
using Windows.Foundation.Collections;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;
using Windows.UI.Xaml.Controls.Primitives;
using Windows.UI.Xaml.Data;
using Windows.UI.Xaml.Input;
using Windows.UI.Xaml.Media;
using Windows.UI.Xaml.Navigation;

namespace DevDiv_HelloWorld
{
    sealed partial class App : Application
    {
        public App()
        {
            this.InitializeComponent();
            this.Suspending += OnSuspending;
        }

        protected override void OnLaunched(LaunchActivatedEventArgs args)
        {
            if (args.PreviousExecutionState == ApplicationExecutionState.Running)
            {
                Window.Current.Activate();
                return;
            }

            if (args.PreviousExecutionState == ApplicationExecutionState.Terminated)
            {
            }

            var rootFrame = new Frame();
            if (!rootFrame.Navigate(typeof(MainPage)))
            {
                throw new Exception(&quot;Failed to create initial page&quot;);
            }

            Window.Current.Content = rootFrame;
            Window.Current.Activate();
        }

        private void OnSuspending(object sender, SuspendingEventArgs e)
        {
            var deferral = e.SuspendingOperation.GetDeferral();
            deferral.Complete();
        }
    }
}</pre>


<p>在上面的代码中，有三个方法</p>

<p>public App()</p>

<p>&#160;&#160;&#160; 该方法用于初始化一个应用程序，我们所写的代码，这里是首先被执行的，逻辑上等价于main() 或WinMain()。</p>

<p>protected override void OnLaunched(LaunchActivatedEventArgs args)</p>

<p>&#160;&#160;&#160; 当用户正常情况下启动完毕了程序，该方法会被调用。当然，也有其它情况下，该方法会被调用，例如：当启动程序以打开指定的文件，或者显示搜索结果，等等。</p>

<p>private void OnSuspending(object sender, SuspendingEventArgs e)</p>

<p>&#160;&#160;&#160; 当程序被中止时，该方法会被调用。</p>

<p>应用程序的生命周期主要就是通过App.xaml.cs文件进行处理的，关于Metro App的生命周期，在后面的学习中，我会进行介绍。现在你只需要知道OnLanunched方法是在程序启动的时候被调用的。在该方法中，会创建并加载MainPage的一个实例，作为应用程序的主入口。</p>

<p>6)MainPage.xaml</p>

<p>下面我们就来看看MainPage.xaml。</p>

<p>我们在刚开始创建Blank App时，VS就会为我们创建一个空白的页面，也就是MainPage.xaml。</p>

<p>如下代码：</p>

<pre class="wp-code-highlight prettyprint linenums:1">&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;?XML:NAMESPACE PREFIX = &quot;[default] http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; NS = &quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; /&gt;&lt;page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:local="using:DevDiv_HelloWorld" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" x:class="DevDiv_HelloWorld.MainPage" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" istabstop="false" mc:ignorable="d"&gt;

    &lt;grid background="{StaticResource ApplicationPageBackgroundThemeBrush}"&gt;
    &lt;/grid&gt;
&lt;/page&gt;</pre>


<p>可以看出，其中包含一个Grid控件。而MainPage.xaml.cs的代码则如下[同样，为了代码简洁，我把注视去掉了]：</p>

<pre class="wp-code-highlight prettyprint linenums:1">using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Windows.Foundation;
using Windows.Foundation.Collections;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;
using Windows.UI.Xaml.Controls.Primitives;
using Windows.UI.Xaml.Data;
using Windows.UI.Xaml.Input;
using Windows.UI.Xaml.Media;
using Windows.UI.Xaml.Navigation;

namespace DevDiv_HelloWorld
{
    public sealed partial class MainPage : Page
    {
        public MainPage()
        {
            this.InitializeComponent();
        }
        protected override void OnNavigatedTo(NavigationEventArgs e)
        {
        }
    }
}</pre>


<p>其中MainPage是初始化函数。OnNavigatedTo方法则是当该页面显示在某个位置的时候，会被调用。</p>

<p>7)Package.appemanifest</p>

<p>最后我们来看看文件Package.appemanifest 。</p>

<p>这是一个提供Metro App信息给Windows runtime的XML文件。信息主要包括：程序显示名称、入口点、支持的旋转、徽标等。</p>

<p>&#160;</p>

<p>3、运行和调试</p>

<p>看下面这个图，我在MainPage页面分别添加了Button,Image和TextBox</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/52.jpg"><img title="5" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="5" src="http://beyondvincent.com/wp-content/uploads/2013/05/5_thumb.jpg" width="682" height="501" /></a></p>

<p>&#160;</p>

<p>下面我给点击按钮添加单击事件，如下图所示，选选中button，然后点击右边的事件按钮，在click中输入ClickButton,然后回车。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/62.jpg"><img title="6" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="6" src="http://beyondvincent.com/wp-content/uploads/2013/05/6_thumb.jpg" width="682" height="448" /></a></p>

<p>&#160;</p>

<p>就可以在MainPage.xaml.cs中看到对应的函数了。如下图所示。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/71.jpg"><img title="7" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="7" src="http://beyondvincent.com/wp-content/uploads/2013/05/7_thumb.jpg" width="682" height="366" /></a></p>

<p>&#160;</p>

<p>下面我们就可以运行并调试代码了,首先，我们在ClickButton处打上断点，稍后运行程序，点击button，就会运行到该方法里面来。</p>

<p>在运行程序之前，我先介绍一下Metro App的调试方法：</p>

<p>如下图所示，程序调试有三种方法：模拟器、本地计算机和远程计算机。</p>

<p>其中远程计算机一般就是连接到本机的win8平半电脑了。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/82.jpg"><img title="8" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="8" src="http://beyondvincent.com/wp-content/uploads/2013/05/8_thumb.jpg" width="634" height="248" /></a></p>

<p>&#160;</p>

<p>在这里，我选择模拟器（Simulator）进行调试程序。点击上图中绿色的三角，或者按F5就可以启动程序进行调试了。</p>

<p>程序在模拟器中的运行画面如下所示。当我们点击button的时候，也会运行到我们之前设置好的断点出。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/91.jpg"><img title="9" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="9" src="http://beyondvincent.com/wp-content/uploads/2013/05/9_thumb.jpg" width="682" height="435" /></a></p>

<p>&#160;</p>

<p>至此，HelloWorld程序的介绍和运行调试就介绍完毕了。</p>

<p>代码文件在此，欢迎下载：</p> </p></p>

<p><a href="https://github.com/BeyondVincent/WindowsStoreAppStepByStep/tree/master/HelloWorld" target="_blank"><img src="http://beyondvincent.com/wp-content/uploads/2013/05/code_xaml.png" /></a></p>

<p>&#160;</p>

<p>4、应用程序包的创建和安装（本地，不通过商店）</p>

<p>&#160;&#160;&#160; 有时候我们在开发Metro App过程中，或开发完毕，我们的用户想要立即体验一下，这时，我们可以不通过微软的商店进行发布，而是通过本地安装就可以。</p>

<p>&#160;&#160;&#160; 这里，我就跟大家分享一下，如何创建应用程序包和在本地安装程序。</p>

<p>a）创建应用程序包</p>

<p>右键单击项目工程文件，如下图所示，选择应用商店->创建应用程序包</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/13.jpg"><img title="1" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="1" src="http://beyondvincent.com/wp-content/uploads/2013/05/1_thumb1.jpg" width="682" height="678" /></a></p>

<p>&#160;</p>

<p>然后会出现如下画面，询问是否创建一个上传至商店的包，这里选择No，我们创建本地使用的包。</p>

<p>注意，下面有文字提示，大概意思是：安装的电脑需要有开发者许可证。</p>

<p>&#160;</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/23.jpg"><img title="2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="2" src="http://beyondvincent.com/wp-content/uploads/2013/05/2_thumb1.jpg" width="682" height="521" /></a></p>

<p>&#160;</p>

<p>然后点击下一步，会让你选择包的路径，版本信息，还有就是相关的配置信息，根据需求选择即可。如下图所示</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/33.jpg"><img title="3" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="3" src="http://beyondvincent.com/wp-content/uploads/2013/05/3_thumb1.jpg" width="682" height="521" /></a></p>

<p>&#160;</p>

<p>最后我们点击创建,过一会，会弹出如下提示框，表示创建完毕</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/43.jpg"><img title="4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="4" src="http://beyondvincent.com/wp-content/uploads/2013/05/4_thumb1.jpg" width="682" height="521" /></a></p>

<p>&#160;</p>

<p>我们打开创建的路径,，会看到如下文件，因为在创建的时候，配置信息我选择了四种包类型，所以这里生成了对应的四种包。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/53.jpg"><img title="5" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="5" src="http://beyondvincent.com/wp-content/uploads/2013/05/5_thumb1.jpg" width="682" height="311" /></a></p>

<p>&#160;</p>

<p>至此，应用程序包就生成好了</p>

<p>&#160;</p>

<p>b）程序包的本地安装</p>

<p>下面我们介绍如何在本地进行程序的安装</p>

<p>如下图，由于我在x86机器上安装，所以我选择DevDiv_HelloWorld_1.0.0.2_x86_Debug_Test该文件，然后右键单击Add-AppDevPackage.ps1，选择使用PowerShell运行</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/14.jpg"><img title="1" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="1" src="http://beyondvincent.com/wp-content/uploads/2013/05/1_thumb2.jpg" width="618" height="341" /></a></p>

<p>&#160;</p>

<p>看到如下画面：提示需要管理员权限，</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/24.jpg"><img title="2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="2" src="http://beyondvincent.com/wp-content/uploads/2013/05/2_thumb2.jpg" width="682" height="425" /></a></p>

<p>&#160;</p>

<p>输入Enter键，并输入管理员账号密码，来到如下画面,提示是否继续</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/34.jpg"><img title="3" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="3" src="http://beyondvincent.com/wp-content/uploads/2013/05/3_thumb2.jpg" width="682" height="400" /></a></p>

<p>&#160;</p>

<p>上面这个画面中，输入Y，并Enter,稍等片刻，就会提示安装成功，如下画面。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/44.jpg"><img title="4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="4" src="http://beyondvincent.com/wp-content/uploads/2013/05/4_thumb2.jpg" width="682" height="353" /></a></p>

<p>&#160;</p>

<p>我们可以在开始画面中看到刚刚安装的程序，如下图</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/54.jpg"><img title="5" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="5" src="http://beyondvincent.com/wp-content/uploads/2013/05/5_thumb2.jpg" width="682" height="410" /></a></p>

<p>&#160;</p>

<p>至此，应用程序包的创建和本地安装就完成了。</p>

<p>谢谢大家的观看。让我们期待下一次的学习吧。</p>

<div style="text-align: left;">
  <span style="color: #339966;">本文由<span style="text-decoration: underline;"><a href="http://beyondvincent.com/"><span style="color: #339966; text-decoration: underline;">破船</span></a></span>原创●转载请注明出处●<time datetime="2013-05-18T17:37:00+08:00" data-updated="true">2012-05-31</time></span>
</div>




		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-31T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 31<span>st</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/step-by-step/'>Step by Step</a>, <a class='category' href='/blog/categories/windowsshang-dian-ying-yong-kai-fa/'>Windows商店应用开发</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/31/27/" itemprop="url">Windows Store App开发[001]平台简介</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p align="left">
  <span style="font-family: 微软雅黑;"><span style="font-size: medium;"> 谈到Windows 8开发，虽然开发者可以直接使用VS来编写代码，但是了解一下</span></span><span style="font-family: 微软雅黑;"><span style="font-size: medium;">Windows 8开发平台是最好的，哪怕只做稍微了解，所谓知己知彼百战百胜嘛。</span></span>
</p>




<p align="left">
  <span style="font-family: 微软雅黑;"><span style="font-size: medium;">    这里我就首先稍微与大家分享一下我所了解的</span></span><span style="font-family: 微软雅黑;"><span style="font-size: medium;">Windows 8开发平台。</span></span>
</p>




<p align="left">
  <span style="font-family: 微软雅黑;"><span style="font-size: medium;">    同时，也欢迎各位大牛来拍砖。</span></span>
</p>




<p align="left">
  <span style="font-family: 微软雅黑;"><span style="font-size: medium;">首先上一个图吧，相信看了图，你对</span></span><span style="font-family: 微软雅黑;"><span style="font-size: medium;">Windows 8的开发会有所了解。</span></span>
</p>




<p align="left">
  <a href="http://beyondvincent.com/wp-content/uploads/2013/05/111.png"><img class="alignnone size-full wp-image-685" alt="111" src="http://beyondvincent.com/wp-content/uploads/2013/05/111.png" width="614" height="441" /></a>
</p>




<p><p align="left">
  <p align="left"></p>

<pre><code>&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;如你所看到的，在Windows 8中有两种基本的方法来创建应用程序，即&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="color: #ff0000;"&gt;Desktop Apps&lt;/span&gt;和&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="color: #ff0000;"&gt;Metro style apps&lt;/span&gt;。&lt;/span&gt;&lt;/span&gt;
</code></pre>

<p>  </p></p>

<p>  <p></p>

<pre><code>&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;    右边的桌面应用程序（Desktop Apps）与现在的情况一样，同样包含WinForms，ASP.NET，C++，WPF，Silverlight等应用程序，也就是说，除了.NET被升级到4.5了，桌面应用程序没有改变。在这里，我们的重点不是桌面应用程序。&lt;/span&gt;&lt;/span&gt;
</code></pre>

<p>  </p></p>

<p>  <p></p>

<pre><code>&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;    上图中，左边才是最大的变化，Metro style apps本质上是一种新型的应用程序，并且它的开发方法也是新的。HTML5/JavaScript是开发Metro app的一种方法，同时，开发者同样可以结合XAML/C#(或XAML/VB，&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;XAML/C-C++&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;)来进行开发。&lt;/span&gt;&lt;/span&gt;
</code></pre>

<p>  </p></p>

<p>  <p></p>

<pre><code>&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;   &lt;span style="color: #ff0000;"&gt; 注意：&lt;/span&gt;在&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;XAML/C#下面，添加了新的一层——WinRT（Windows Runtime library）。也就是说，在创建Metro app时，WinRT给开发者提供了Windows强大的功能，在&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 微软雅黑;"&gt;&lt;span style="font-size: medium;"&gt;WinRT之上，开发者可以选择C#，VB,C++或者JavaScript。&lt;/span&gt;&lt;/span&gt;
</code></pre>

<p>  </p></p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-30T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 30<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ios/'>iOS</a>, <a class='category' href='/blog/categories/ioskai-fa-ji-lu/'>iOS开发记录</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/30/26/" itemprop="url">Could Not Change Executable Permissions on the Application</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h2><strong><span style="color: #339966;">Bug描述</span></strong></h2>

<p>利用Xcode编译调试程序的时候提示：Could not change executable permissions on the application。如下图：</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130530-1.png"><img class="alignnone size-full wp-image-727" alt="QQ20130530-1" src="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130530-1.png" width="420" height="153" /></a></p>

<p>&nbsp;</p>

<h2><strong><span style="color: #339966;">Bug再现步骤</span></strong></h2>

<p>首先通过企业级部署，在一台iOS设备上安装一个程序，然后再通过Xcode对同一个程序（相同的Bundle Identifier）在相同的设备上进行编译调试，就会遇到这个问题。</p>

<h2><strong><span style="color: #339966;">Bug原因分析</span></strong></h2>

<p>可能是由于企业级部署的时候用的是发布证书，而Xcode调试的时候用的是开发者证书，在遇到上面的情况时，Xcode无法正确识别文件，因此出现问题。</p>

<h2><strong><span style="color: #339966;">Bug修复</span></strong></h2>

<p>删除设备上通过企业级部署安装的程序，在用Xcode进行编译调试即可正确启动程序。</p>

<h2><strong><span style="color: #339966;">参考</span></strong></h2>

<ul>
<li><span style="text-decoration: underline;"><a href="http://stackoverflow.com/questions/12547706/could-not-change-executable-permissions-on-the-application" target="_blank"><span style="color: #339966; text-decoration: underline;">Could not change executable permissions on the application</span></a></span></li>
<li><span style="text-decoration: underline;"><a href="http://www.cocoachina.com/bbs/read.php?tid=116477" target="_blank"><span style="color: #339966; text-decoration: underline;">could not change executable permissions怎么办</span></a></span></li>
</ul>


<div style="text-align: left;">
  <span style="color: #339966;">本文由<span style="text-decoration: underline;"><a href="http://beyondvincent.com/"><span style="color: #339966; text-decoration: underline;">破船</span></a></span>原创●转载请注明出处●<time datetime="2013-05-18T17:37:00+08:00" data-updated="true">2012-05-30</time></span>
</div>




		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-22T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 22<span>nd</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ios/'>iOS</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/22/25/" itemprop="url">iOS设计速查表</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/QQ%E6%88%AA%E5%9B%BE20130522204855.png"><img class="alignnone size-full wp-image-658" alt="QQ截图20130522204855" src="http://beyondvincent.com/wp-content/uploads/2013/05/QQ截图20130522204855.png" width="1279" height="701" /></a></p>

<p>&nbsp;</p>

<p>PDF文档下载地址（访问密码：af99）</p>

<p><a href="http://yunpan.cn/Q5MBetKcSNm8A" target="_blank"><img class="alignnone size-full wp-image-563" alt="pdf-icon" src="http://beyondvincent.com/wp-content/uploads/2013/05/pdf-icon.png" width="150" height="150" /></a><br/>
参考文档：</p>

<p><span style="color: #339966;"><a href="http://taybenlor.com/2013/05/21/designing-for-ios.html" target="_blank"><span style="color: #339966;">Starters Guide to iOS Design</span></a></span></p>

<p><span style="color: #339966;"><a href="http://ivomynttinen.com/blog/the-ios-design-cheat-sheet-volume-2/" target="_blank"><span style="color: #339966;">The iOS Design Cheat Sheet</span></a></span></p>

<p>&nbsp;</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-17T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 17<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ios/'>iOS</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/17/24/" itemprop="url">在iOS中使用FlatUIKit</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h2><a href="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130517-3.png"><img class="alignnone size-full wp-image-647" alt="QQ20130517-3" src="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130517-3.png" width="1021" height="334" /></a></h2>

<h2><strong><span style="color: #339966;">简介</span></strong></h2>

<p>FlatUIKit是iOS中具有扁平化风格的UI（Flat UI）组件。FlatUIKit的设计灵感来源于<span style="text-decoration: underline;"><span style="color: #339966;"><a href="http://designmodo.github.io/Flat-UI/" target="_blank"><span style="color: #339966; text-decoration: underline;">Flat UI</span></a></span></span>和<span style="text-decoration: underline;"><span style="color: #339966;"><a href="http://kylemillercreative.com/#item=grouper" target="_blank"><span style="color: #339966; text-decoration: underline;">Kyle Miller</span></a></span></span>。FlatUIKit中的组件是通过扩展(category)或继承iOS SDK中已有的UIKit组件来实现的，因此在我们的程序中使用FlatUIKit非常方便。</p>

<h2><strong><span style="color: #339966;">安装</span></strong></h2>

<p>可以通过Cocoapods安装FlatUIKit，简单的在Profile文件中添加：pod &#8216;FlatUIKit&#8217;就可以。</p>

<p>关于Cocoapods的使用可以参考本文最后参考部分相关内容。</p>

<p>如果你没有使用CocoaPods，也可以简单的将<span style="text-decoration: underline;"><span style="color: #339966;"><a href="https://github.com/Grouper/FlatUIKit/archive/master.zip" target="_blank"><span style="color: #339966; text-decoration: underline;">代码</span></a></span></span>下载到本地，并手动添加到你的工程中。</p>

<p>注意：FlatUIKit需要CoreText框架以及iOS > 5.0.</p>

<h2><span style="color: #339966;">FlatUIKit中提供的组件</span></h2>

<h3><span style="color: #339966;">Buttons</span></h3>

<p>FUIButton是UIButton的一个子类，它向外接提供了四个属性：buttonColor, shadowColor, cornerRadius, 和 shadowHeight。</p>

<p>注意：如果如果你设置了其中一个属性的值，那么其它所有的属性你都需要进行设置。</p>

<pre class="wp-code-highlight prettyprint linenums:1">myButton.buttonColor = [UIColor turquoiseColor];
myButton.shadowColor = [UIColor greenSeaColor];
myButton.shadowHeight = 3.0f;
myButton.cornerRadius = 6.0f;
myButton.titleLabel.font = [UIFont boldFlatFontOfSize:16];
[myButton setTitleColor:[UIColor cloudsColor] forState:UIControlStateNormal];
[myButton setTitleColor:[UIColor cloudsColor] forState:UIControlStateHighlighted];</pre>


<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569627574746f6e2d736d616c6c2e676966.gif"><img alt="687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569627574746f6e2d736d616c6c2e676966" src="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569627574746f6e2d736d616c6c2e676966.gif" width="127" height="66" /></a></p>

<h3> <strong><span style="color: #339966;">Switchs</span></strong></h3>

<p>FUISwitch并不是UISwitch的一个子类（UISwitch不容易继承），而是重新实现了一个与UISwitch类似的控件，提供了UISwitch具有的所有方法。另外还提供了on/off(UILable)和其它subview的访问。</p>

<pre class="wp-code-highlight prettyprint linenums:1">mySwitch.onColor = [UIColor turquoiseColor];
mySwitch.offColor = [UIColor cloudsColor];
mySwitch.onBackgroundColor = [UIColor midnightBlueColor];
mySwitch.offBackgroundColor = [UIColor silverColor];
mySwitch.offLabel.font = [UIFont boldFlatFontOfSize:14];
mySwitch.onLabel.font = [UIFont boldFlatFontOfSize:14];</pre>


<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f6675697377697463682d736d616c6c2e676966.gif"><img class="alignnone size-full wp-image-641" alt="687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f6675697377697463682d736d616c6c2e676966" src="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f6675697377697463682d736d616c6c2e676966.gif" width="113" height="53" /></a></p>

<h3><span style="color: #339966;">Alert Views</span></h3>

<p>跟FUISwitch一样，FUIAlertView对UIAlertView进行了重写，并提供了UIAlertView具有的所有方法（包括delegate方法，在FUIAlertViewDelegate协议中），FUIAlertView的定制要比UIAlertView更加灵活。FUIAlertView中的所有UILabels, UIViews, 和 FUIButtons 都可以定制.</p>

<pre class="wp-code-highlight prettyprint linenums:1">FUIAlertView *alertView = [[FUIAlertView alloc] initWithTitle:@"Hello"
                                                      message:@"This is an alert view"
                                                     delegate:nil cancelButtonTitle:@"Dismiss"
                                            otherButtonTitles:@"Do Something", nil];
alertView.titleLabel.textColor = [UIColor cloudsColor];
alertView.titleLabel.font = [UIFont boldFlatFontOfSize:16];
alertView.messageLabel.textColor = [UIColor cloudsColor];
alertView.messageLabel.font = [UIFont flatFontOfSize:14];
alertView.backgroundOverlay.backgroundColor = [[UIColor cloudsColor] colorWithAlphaComponent:0.8];
alertView.alertContainer.backgroundColor = [UIColor midnightBlueColor];
alertView.defaultButtonColor = [UIColor cloudsColor];
alertView.defaultButtonShadowColor = [UIColor asbestosColor];
alertView.defaultButtonFont = [UIFont boldFlatFontOfSize:16];
alertView.defaultButtonTitleColor = [UIColor asbestosColor];
[alertView show];</pre>


<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569616c657274766965772d736d616c6c2e676966.gif"><img class="alignnone size-full wp-image-642" alt="687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569616c657274766965772d736d616c6c2e676966" src="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569616c657274766965772d736d616c6c2e676966.gif" width="316" height="336" /></a></p>

<h3><strong><span style="color: #339966;"> Sliders/Steppers/Progress Views</span></strong></h3>

<p>为了提供扁平风格的UISlider， UIProgressView 和 UIStepper，这里简单的对UISlider/ProgressView/UIStepper进行了扩展，通过适当的颜色/圆角半径就能自动配置它们的外观。在已有的工程中不需要做任何改动就能使用这些组件。</p>

<pre class="wp-code-highlight prettyprint linenums:1">[mySlider configureFlatSliderWithTrackColor:[UIColor silverColor]
                              progressColor:[UIColor alizarinColor]
                                 thumbColor:[UIColor pomegranateColor]];</pre>


<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569736c696465722d736d616c6c2e676966.gif"><img class="alignnone size-full wp-image-643" alt="687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569736c696465722d736d616c6c2e676966" src="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569736c696465722d736d616c6c2e676966.gif" width="296" height="44" /></a></p>

<pre class="wp-code-highlight prettyprint linenums:1">[myProgressView configureFlatProgressViewWithTrackColor:[UIColor silverColor]
                              progressColor:[UIColor alizarinColor]];</pre>


<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130517-1.png"><img class="alignnone size-full wp-image-644" alt="QQ20130517-1" src="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130517-1.png" width="294" height="42" /></a></p>

<pre class="wp-code-highlight prettyprint linenums:1">[myStepper configureFlatStepperWithColor:[UIColor wisteriaColor]
                        highlightedColor:[UIColor wisteriaColor]
                           disabledColor:[UIColor amethystColor]
                               iconColor:[UIColor cloudsColor]];</pre>


<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569737465707065722d736d616c6c2e676966.gif"><img class="alignnone size-full wp-image-645" alt="687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569737465707065722d736d616c6c2e676966" src="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f667569737465707065722d736d616c6c2e676966.gif" width="119" height="51" /></a></p>

<h3><strong><span style="color: #339966;">Bar Button Items</span></strong></h3>

<p>为了定制整个程序中的bar button items（包括back buttons），UIBarButtonItem+FlatUI提供了一个类方法，通过该方法可以只需要一步就能利用UIBarButton Item的外观代理（appearance proxy）：</p>

<pre class="wp-code-highlight prettyprint linenums:1">[UIBarButtonItem configureFlatButtonsWithColor:[UIColor peterRiverColor]
                              highlightedColor:[UIColor belizeHoleColor]
                                  cornerRadius:3];</pre>


<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f6675696e61766261722d736d616c6c2e676966.gif"><img class="alignnone size-full wp-image-646" alt="687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f6675696e61766261722d736d616c6c2e676966" src="http://beyondvincent.com/wp-content/uploads/2013/05/687474703a2f2f626c6f672e6a6f696e67726f757065722e636f6d2f466c617455494b69742f696d616765732f6675696e61766261722d736d616c6c2e676966.gif" width="322" height="44" /></a></p>

<h3><strong><span style="color: #339966;"> Navigation Bars</span></strong></h3>

<p>跟上面的Bar Button Items一样，对UINavigationBar进行了扩展——利用一个颜色对其进行扁平花的配置。</p>

<pre class="wp-code-highlight prettyprint linenums:1">self.navigationController.navigationBar configureFlatNavigationBarWithColor:[UIColor midnightBlueColor]];</pre>


<h3><strong><span style="color: #339966;">Colors</span></strong></h3>

<p>为了方便，FlatUIKit包含了Flat UI颜色的定义。这里的UIColor+FlatUI对UIColor进行了扩展，可以在UIColor+FlatUI.h/m文件中看到各种Flat UI颜色的定义。使用方法非常简单：</p>

<pre class="wp-code-highlight prettyprint linenums:1">#import &lt;FlatUIKit/UIColor+FlatUI.h&gt;
UIColor *myColor = [UIColor turquoiseColor];</pre>


<h3><strong><span style="color: #339966;">Fonts</span></strong></h3>

<p>FlatUIKit使用的是Lato字体，改字体是干净，漂亮的开放字体，更多相关Lato信息可以在<span style="text-decoration: underline;"><span style="color: #339966;"><a href="http://www.latofonts.com/" target="_blank"><span style="color: #339966; text-decoration: underline;">这里</span></a></span></span>看到。改字体自动的包含在了FlatUIKit中；按照如下方式使用即可：</p>

<pre class="wp-code-highlight prettyprint linenums:1">#import "UIFont+FlatUI.h"
UIFont *myFont = [UIFont flatFontOfSize:16];</pre>


<h2></h2>

<h2><strong><span style="color: #339966;">参考</span></strong></h2>

<p>CocoaPods相关：</p>

<p><span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="http://blog.devtang.com/blog/2012/12/02/use-cocoapod-to-manage-ios-lib-dependency/" target="_blank"><span style="color: #339966; text-decoration: underline;">使用CocoaPods来做iOS程序的包依赖管理</span></a> </span></span>来自唐巧的一篇精彩博文<br/>
<span style="text-decoration: underline; color: #339966;"><span style="text-decoration: underline;"><a href="https://github.com/CocoaPods/CocoaPods" target="_blank"><span style="text-decoration: underline; color: #339966;"> GitHub上的CocoaPods</span></a></span></span></p>

<p>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<em><em><strong><br/>
本文由破船译自：<span style="text-decoration: underline;"><span style="color: #339966;"><a href="https://github.com/Grouper/FlatUIKit" target="_blank"><span style="color: #339966; text-decoration: underline;">FlatUIKit</span></a></span></span><br/>
转载请注明出处：<span style="text-decoration: underline;"><span style="color: #339966;"><strong><a href="http://www.beyondvincent.com/" target="_blank"><span style="color: #339966; text-decoration: underline;">BeyondVincent的博客</span></a></strong></span></span><br/>
_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong></em></em></p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-16T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 16<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ios/'>iOS</a>, <a class='category' href='/blog/categories/iosshe-ji-mo-shi/'>iOS设计模式</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/16/23/" itemprop="url">iOS设计模式(03):工厂方法</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<h2><strong><span style="color: #339966;">什么是工厂方法？</span></strong></h2>

<p>GOF是这样描述工厂模式的：</p>

<blockquote><p>Define an interface for creating an object, but let subclasses decide which class to instantiate. Factory Method lets a class defer instantiation to subclasses.</p></blockquote>

<p>在基类中定义创建对象的一个接口，让子类决定实例化哪个类。工厂方法让一个类的实例化延迟到子类中进行。</p>

<p>工厂方法要解决的问题是对象的创建时机，它提供了一种扩展的策略，很好地符合了开放封闭原则。工厂方法也叫做虚构造器（Virtual Constructor）。</p>

<p>如下图所示，是工厂方法的类结构图：<a href="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130516-4.png"><img class="alignnone size-full wp-image-600" alt="QQ20130516-4" src="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130516-4.png" width="829" height="300" /></a></p>

<p><strong style="font-size: 1.5em;"><span style="color: #339966;">什么时候使用工厂方法？</span></strong></p>

<p>当是如下情况是，可以使用工厂方法：</p>

<ol>
<li>一个类不知道它所必须创建的对象的类时</li>
<li>一个类希望有它的子类决定所创建的对象时</li>
</ol>


<p>更多关于工厂方法的介绍，可以参考本文最后给出的参考内容。下面我们就来看看在iOS中工厂方法的一种实现方法。</p>

<h2><strong><span style="color: #339966;">iOS中工厂方法的实现</span></strong></h2>

<p>如下有一个类图，该图描述了下面即将实现的工厂方法（利用工厂方法，创建出不同的形状）。其中BVShapeFactory为工厂方法的基类，BVShape为形状的基类，BVClient通过BVShapeFactory，利用 BVShapeFactory的子类（BVCircleShapeFactory和BVSquareShapeFactory）分别创建出BVCircleShape和BVSquareShape。</p>

<h2><a href="http://beyondvincent.com/wp-content/uploads/2013/05/factory-method-pattern.png"><img class="alignnone size-full wp-image-599" title="点击图片查看大图" alt="factory-method-pattern" src="http://beyondvincent.com/wp-content/uploads/2013/05/factory-method-pattern.png" width="1181" height="384" /></a></h2>

<p>如下图，是在Xcode中创建的相关文件</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130516-5.png"><img class="alignnone size-full wp-image-606" alt="QQ20130516-5" src="http://beyondvincent.com/wp-content/uploads/2013/05/QQ20130516-5.png" width="261" height="426" /></a></p>

<p>具体实现步骤如下（建议下载本文最后给出的代码实例，用Xcode查阅代码）：</p>

<ol>
<li>创建一个形状基类BVShape</li>
</ol>


<p>该类中定义了形状的基本行为和属性，如下代码所示：</p>

<p>BVShape.h</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVShape.h
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#define BV_Exception_Format @"在%@的子类中必须override:%@方法"

@interface BVShape : NSObject

@property (nonatomic, weak)NSString *name;

// 子类必须重写这个draw方法，否则会抛出异常错误
-(void)draw;

@end</pre>


<p>BVShape.m</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVShape.m
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVShape.h"

@implementation BVShape

-(id)init
{
   self = [super init];
    if (self) {
        // 做一些初始化任务
    }
    return self;
}

-(void)draw
{
    // 如果是通过BVShape的实例调用此处的draw，则绘制一个BVShape图形
    if ([self isMemberOfClass:[BVShape class]]) {
        NSLog(@"绘制一个BVShape图形");
    } else {
        // 如果是通过BVShape子类的实例调用了此处的draw，则抛出一个异常：表明子类并没有重写draw方法。
        // 注：在OC中并没有abstract class的概念，只有protocol，如果在基类中只定义接口(没有具体方法的实现)，
        //    则可以使用protocol，这样会更方便。 
        [NSException raise:NSInternalInconsistencyException
                    format:BV_Exception_Format, [NSString stringWithUTF8String:object_getClassName(self)], NSStringFromSelector(_cmd)];
    }
}

@end</pre>


<p>在上面的代码中定义了一个draw方法，为了让子类必须实现该方法，在BVShape中做了特殊处理，具体内容可以看上面的代码，已经有注视了。</p>

<ol start="2">
  <li>
    子类化形状基类
  </li>
</ol>


<p>首先子类化一个圆形类：BVCircleShape。</p>

<p>BVCircleShape.h</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVCircleShape.h
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVShape.h"

@interface BVCircleShape : BVShape

@end</pre>


<p>BVCircleShape.m</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVCircleShape.m
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVCircleShape.h"

@implementation BVCircleShape

-(void)draw
{
    NSLog(@"绘制一个BVCircleShape图形");
}

@end</pre>


<p>在上面的子类中，重写了基类的draw方法。同样，我们再子类化一个正方形类，并重写draw方法，如下代码所示：</p>

<p>BVSquareShape.h</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVSquareShape.h
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVShape.h"

@interface BVSquareShape : BVShape

@end</pre>


<p>BVSquareShape.m</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVSquareShape.m
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVSquareShape.h"

@implementation BVSquareShape

-(void)draw
{
    NSLog(@"绘制一个BVSquareShape图形");
}

@end</pre>




<ol start="3">
  <li>
     创建一个工厂方法的基类BVShapeFactory
  </li>
</ol>


<p>BVShapeFactory.h</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVShapeFactory.h
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVShape.h"

@interface BVShapeFactory : NSObject

-(BVShape *) factoryMethod;

@end</pre>


<p>BVShapeFactory.m</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVShapeFactory.m
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVShapeFactory.h"

@implementation BVShapeFactory

-(BVShape *)factoryMethod
{
    // 在此处，子类必须重写factoryMethod方法。当然，在工厂模式中，也可以在此处返回一个默认的Product。
    // 如果是通过BVShapeFactory子类的实例调用了此处的factoryMethod，则抛出一个异常：表明子类并没有重写factoryMethod方法。
    [NSException raise:NSInternalInconsistencyException
                format:BV_Exception_Format, [NSString stringWithUTF8String:object_getClassName(self)], NSStringFromSelector(_cmd)];

    // 下面这个return语句只是为了消除警告，实际上永远都不会执行到这里。
    return nil;
}

@end</pre>


<p>在上面的代码中，定义了一个factoryMethod，该类的子类必须实现该方法，通过实现该方法，返回一个具体的形状对象。下面来看看该类的子类化。</p>

<ol start="4">
  <li>
    子类化工厂方法的基类
  </li>
</ol>


<p>首先子类化一个圆形工厂方法BVCircleShapeFactory：</p>

<p>BVCircleShapeFactory.h</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVCircleShapeFactory.h
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVShapeFactory.h"
#import "BVCircleShape.h"

@interface BVCircleShapeFactory : BVShapeFactory

@end</pre>


<p>BVCircleShapeFactory.m</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVCircleShapeFactory.m
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVCircleShapeFactory.h"

@implementation BVCircleShapeFactory

-(BVShape *)factoryMethod
{
    return [[BVCircleShape alloc] init];
}

@end</pre>


<p>如上代码所示，重写了factoryMethod，返回一个BVCircleShape实例。下面来看看另外一个子类BVSquareShapeFactory：</p>

<p>BVSquareShapeFactory.h</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVSquareShapeFactory.h
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVShapeFactory.h"
#import "BVSquareShape.h"

@interface BVSquareShapeFactory : BVShapeFactory

@end</pre>


<p>BVSquareShapeFactory.m</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVSquareShapeFactory.m
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVSquareShapeFactory.h"

@implementation BVSquareShapeFactory

-(BVShape *)factoryMethod
{
    return [[BVSquareShape alloc] init];
}

@end</pre>


<p>该子类返回的是一个BVSquareShape实例。</p>

<ol start="5">
  <li>
    工厂方法的使用
  </li>
</ol>


<p>定义一个BVClient类，在该类中演示工厂方法的使用。代码如下：</p>

<p>BVClient.h</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVClient.h
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

@interface BVClient : NSObject

-(void)doSomething;

@end</pre>


<p>BVClient.m</p>

<pre class="wp-code-highlight prettyprint linenums:1">//
//  BVClient.m
//  FactoryMethodPattern
//
//  Created by BeyondVincent on 13-5-15.
//  Copyright (c) 2013年 BeyondVincent. All rights reserved.
//

#import "BVClient.h"

#import "BVShapeFactory.h"
#import "BVCircleShapeFactory.h"
#import "BVSquareShapeFactory.h"

#import "BVShape.h"
#import "BVCircleShape.h"
#import "BVSquareShape.h"

@implementation BVClient

-(void)doSomething
{
    // 工厂方法的实例化
    BVShapeFactory *circleShapefactory = [[BVCircleShapeFactory alloc] init];
    BVShapeFactory *squareShapefactory = [[BVSquareShapeFactory alloc] init];

    // 通过工厂方法实例化对应的形状
    BVShape *circleShape = [circleShapefactory factoryMethod];
    BVShape *squareShape = [squareShapefactory factoryMethod];

    // 调用形状的方法
    [circleShape draw];
    [squareShape draw];
}

@end</pre>


<p>如上代码所示，首先实例化两个工厂方法，并通过工厂方法创建出对应的形状，最后调用形状的draw方法进行测试。会在控制台窗口输出如下内容：</p>

<pre class="wp-code-highlight prettyprint linenums:1">2013-05-16 10:12:46.292 FactoryMethodPattern[2845:c07] 绘制一个BVCircleShape图形
2013-05-16 10:12:46.295 FactoryMethodPattern[2845:c07] 绘制一个BVSquareShape图形</pre>


<h2><span style="color: #339966;"><strong>代码实例</strong></span></h2>

<p>本文涉及到的相关实例代码和PDF归档可以到点击下图下载：</p>

<p><a href="https://github.com/BeyondVincent/ios_patterns/tree/master/FactoryMethodPattern" target="_blank"><img alt="代码下载" src="http://beyondvincent.com/wp-content/uploads/2013/05/5555.png" width="150" height="150" /></a>            <a href="https://github.com/BeyondVincent/ios_patterns/raw/master/FactoryMethodPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%20For%20iOS-03-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95.pdf" target="_blank"><img alt="pdf-icon" src="http://beyondvincent.com/wp-content/uploads/2013/05/pdf-icon.png" width="150" height="150" /></a></p>

<h2><span style="color: #339966;"><strong>参考</strong></span></h2>

<p>在学习工厂方法时，参考了如下一些文章和视频：</p>

<p><span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="http://zh.wikipedia.org/wiki/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95" target="_blank"><span style="color: #339966; text-decoration: underline;">工厂方法</span></a></span></span>wiki上对工厂方法的介绍<br/>
<span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="http://developer.apple.com/library/ios/#documentation/General/Conceptual/CocoaEncyclopedia/ClassFactoryMethods/ClassFactoryMethods.html" target="_blank"><span style="color: #339966; text-decoration: underline;">Class Factory Methods</span></a> </span></span>苹果官网对类工厂方法的介绍<br/>
<span style="text-decoration: underline; color: #339966;"><span style="text-decoration: underline;"><span style="text-decoration: underline;"><a href="http://maleevdimka.wordpress.com/2013/01/23/ios-patterns-fabric-method/" target="_blank"><span style="color: #339966; text-decoration: underline;">iOS Patterns. Factory Method</span></a></span></span></span><span style="color: #000000;">(一篇介绍工厂方法的文章，俄文，需要楼梯)</span><br/>
<span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="http://my.safaribooksonline.com/book/programming/objective-c/9781430233305/chapter-4-factory-method/what_is_the_factory_method_pattern_quest" target="_blank"><span style="color: #339966; text-decoration: underline;">What Is the Factory Method Pattern?</span></a></span></span>（Pro Objective-C Design Patterns for iOS书中对工厂方法的介绍）<br/>
<span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="http://terrylee.cnblogs.com/archive/2006/01/04/310716.html " target="_blank"><span style="color: #339966; text-decoration: underline;">.NET设计模式（5）：工厂方法模式（Factory Method）</span></a></span></span><br/>
<span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="http://blog.csdn.net/cjjky/article/details/7314118" target="_blank"><span style="color: #339966; text-decoration: underline;">java实现工厂方法</span></a></span></span><br/>
<span style="text-decoration: underline; color: #339966;"><a href="http://www.youtube.com/watch?feature=player_detailpage&v=cDF5tyiamww" target="_blank"><span style="color: #339966; text-decoration: underline;">JAVA: Factory Method Design Pattern</span></a></span><span style="color: #000000;">youtube上一个关于工厂方法的视频介绍</span><br/>
<span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="http://stackoverflow.com/questions/3653929/iphone-sdk-difference-between-iskindofclass-and-ismemberofclass" target="_blank"><span style="color: #339966; text-decoration: underline;">iphone-sdk-difference-between-iskindofclass-and-ismemberofclass</span></a></span></span> iskindofclass和ismemberofclass区别</p>

<p>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<em><em><strong><br/>
本文由破船原创<br/>
转载请注明出处：<span style="text-decoration: underline;"><span style="color: #339966;"><strong><a href="http://www.beyondvincent.com/" target="_blank"><span style="color: #339966; text-decoration: underline;">BeyondVincent的博客</span></a></strong></span></span><br/>
_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong></em></em></p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-16T00:00:00+08:00" data-updated="true" itemprop="datePublished">May 16<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/ios/'>iOS</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/16/22/" itemprop="url">iOS调试 — 基本技巧</a></h1>
	<div class="entry-content" itemprop="articleBody">
		<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/ios_debug.png"><img class="alignnone size-full wp-image-628" alt="ios_debug" src="http://beyondvincent.com/wp-content/uploads/2013/05/ios_debug.png" width="976" height="313" /></a></p>

<p>在程序中，无论是你想弄清楚为什么数组中有3个对象而不是5个，或者为什么一个新的玩家开始之后，游戏在倒退——调试在这些处理过程中是比较重要的一部分。通过本文的学习，我们将知道在程序中，可以使用的大多数重要调试功能，并如何利用这些调试功能来帮助你以更少的时间解决bug。</p>

<p>本文将介绍如下内容：</p>

<ul>
<li>使用控制台检查程序的状态</li>
<li>进行日志记录，并熟练的驾驭NSLog</li>
<li>利用对象的生命周期跟踪内存的使用</li>
</ul>


<h2><strong><span style="color: #339966;">使用控制台进行检查</span></strong></h2>

<p>在进行调试程序的时候，可能Xcode底部的小黑框会是你最好的朋友。它能输出日志信息，错误信息以及其它各种有用的内容——这可以帮助你进行错误的跟踪。除了可以在看到日志的输出，我们还可以在某个断点出停留住，并检查程序中的变量信息。</p>

<h3><strong><span style="color: #339966;">带条件的断点</span></strong></h3>

<p>本文假设你以及知道断点是如何工作的了（即使不知道的话，也不用担心，看完本文之后，你将明白！）。</p>

<p>在某个特定的时间点命中断点是非常重要的，在有些断点中，有些时候需要通过一个痛苦的循环或者递归函数才能让我们的对象等于某个确定的值。此时我们可以使用条件断点！</p>

<p>条件断点是这样的一类断点：只有当满足某个确定的条件时，才会命中断点。可以想象一下：我们只希望当对象在某个确定的状态，或者循环迭代到第nth次时才命中断点。单击Xcode editor中的‘gutter’可以添加一个断点，在断点上单击右键，然后选择‘edit breakpoint’，就可以设置特定的条件了。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/conditionalBreakpoints.png"><img class="alignnone size-full wp-image-617" alt="conditionalBreakpoints" src="http://beyondvincent.com/wp-content/uploads/2013/05/conditionalBreakpoints.png" width="513" height="223" /></a></p>

<p>可以提供一个条件（例如i==12），或者断点忽略次数。另外还可以添加动作，该动作可根据断点自动发生，例如一个debugger command——打印一个值。</p>

<p><span style="color: #339966;"><strong>提示</strong></span>：添加/删除断点的键盘快捷键是command+\</p>

<p>另外一个重要的断点技巧是添加一个异常断点(exception breakpoint)。当遇到异常时，基本99%次Xcode都会自动转到main方法中的autorelease pool中。</p>

<div id="attachment_618" class="wp-caption alignnone" style="width: 682px">
  <a href="http://beyondvincent.com/wp-content/uploads/2013/05/unhelpful_break.png"><img class="size-full wp-image-618 " alt="unhelpful_break" src="http://beyondvincent.com/wp-content/uploads/2013/05/unhelpful_break.png" width="672" height="179" /></a><p class="wp-caption-text">
    感谢Xcode&#8230;真的太有用了！
  </p>
</div>


<p>通过异常断点，可以方便的定位到引起异常发生的具体代码行。异常断点的添加方法：打开异常断点tab（command+6）。选择窗口左下角的&#8221;+&#8221;按钮，并添加一个‘exception breakpoint’，这样，当Xcode遇到异常时，将会在引起异常代码的地方发生断点停留。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/Exception-breakpoint.png"><img class="alignnone size-full wp-image-619" alt="Exception-breakpoint" src="http://beyondvincent.com/wp-content/uploads/2013/05/Exception-breakpoint.png" width="501" height="194" /></a></p>

<h2><strong><span style="color: #339966;">在控制台进行手动打印</span></strong></h2>

<p>一般情况下，我们在程序代码中添加断点，是为了通过Xcode提供的‘variables view’（该view在Xcode底部console旁边）来查看变量的状态 。理论上，该窗口可以显示出与当前上下文相关的所有值的状态。实际上，这有点小问题，有时候断点过了之后，该窗口并不会进行相关的更新。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/variables-view.png"><img class="alignnone size-full wp-image-620" alt="variables view" src="http://beyondvincent.com/wp-content/uploads/2013/05/variables-view.png" width="579" height="210" /></a></p>

<p>&nbsp;</p>

<p>很不错的一个功能是：我们可以使用控制台的命令来检查某个特定的对象——这非常有用。在控制台输入‘<span style="color: #339966;">po</span>’就可以打印出指定对象的即时信息（处理scalar值时使用‘p’）。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/po_command.png"><img class="alignnone size-full wp-image-621" alt="po_command" src="http://beyondvincent.com/wp-content/uploads/2013/05/po_command.png" width="818" height="92" /></a></p>

<p>&nbsp;</p>

<p>在查看一个已经存在的对象时，这非常有用（如果对象不存在的话会打印出nil）——确定对象的值，查看数组/字典在运行时的信息，甚至是两个对象的比较（这个命令可以打印出相关对象的内存地址，我们可以打印出两个对象的信息，然后看看它们的内存地址是否相同）。</p>

<p>另外非常有用（但是被隐藏的命令）可以非常容易的对view进行检查——<span style="color: #339966;">the<em>recursiveDescription</em></span>命令——在view上调用这个命令可以打印出view的继承关系。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/recursiveDescription.png"><img class="alignnone size-full wp-image-622" alt="recursiveDescription" src="http://beyondvincent.com/wp-content/uploads/2013/05/recursiveDescription.png" width="607" height="89" /></a></p>

<h2><strong><span style="color: #339966;"> 有效的进行Log</span></strong></h2>

<p>&nbsp;</p>

<p>有时候在进行程序调试的某个确定时间里，我们希望将消息打印到控制台，此时可以使用<span style="color: #339966;">NSLog</span>函数，通过该函数可以将任意的输出打印到控制台。在不使用断点时，这个功能非常有用。NSLog遵从的格式与<em>[NSString StringWithFormat]</em>方法遵从的格式一样。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/nslog_use.png"><img class="alignnone size-full wp-image-623" alt="nslog_use" src="http://beyondvincent.com/wp-content/uploads/2013/05/nslog_use.png" width="595" height="78" /></a></p>

<p><strong>提示</strong>：这里可以看到Objective-C中关于字符串格式化的信息：<span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"> <a title="String Programming Guide" href="https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/FormatStrings.html"><span style="color: #339966; text-decoration: underline;">String Programming Guide</span></a></span></span></p>

<h3><strong><span style="color: #339966;">让NSLog更加智能</span></strong></h3>

<p>虽然NSLog非常有用，但是在真机上，从NSLog打印出来的任何内容都会被保留，隐藏所有人都可以看到——只需要将设备连接到电脑，然后打开XCode中的organiser，并定位到console，就可以看到每条log信息。可能你会意识到，这会带来一些严重的影响！想一下，如果你将一些保密的算法逻辑，或者用户密码打印到控制台！因此，如果苹果检测到在production build中，输出许多内容到控制台时，你的应用可能会被苹果拒绝上架到商店。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/nslog_public.png"><img class="alignnone size-full wp-image-624" alt="nslog_public" src="http://beyondvincent.com/wp-content/uploads/2013/05/nslog_public.png" width="981" height="292" /></a></p>

<p>&nbsp;</p>

<p>幸运的是，这里有一个最简单的办法进行log——通过一个宏，让NSLog只在debug build的时候起作用。将这个功能添加到全局都能访问得到的头文件中。这样你就可以尽情的使用log了，并且当进行production时，不会包含log相关代码。如下代码：</p>

<pre class="wp-code-highlight prettyprint linenums:1">#ifdef DEBUG
#define DMLog(...) NSLog(@"%s %@", __PRETTY_FUNCTION__, [NSString stringWithFormat:__VA_ARGS__])
#else
#define DMLog(...) do { } while (0)</pre>


<p>现在如果使用DMLog，那么将只会在debug build期间打印出log。而production build时则不会有任何log。通过<em>__PRETTY_FUNCTION\__</em> 可以打印出打印log所在的函数。</p>

<h3><strong><span style="color: #339966;">下一步</span></strong></h3>

<p>虽然NSLog非常出色，但它也有一些限制：</p>

<ul>
<li>只能在本地打印</li>
<li>不支持带级别的log（例如严重、警告等）</li>
<li>NSLog效率低。在进行大量处理时，NSLog会严重影响程序的执行效率</li>
</ul>


<p>互联网上也有一些框架可以进行日志记录，通过这些框架可以避免NSLog的一些限制。下面有两个不错的：</p>

<ul>
<li><span style="text-decoration: underline;"><span style="color: #339966; text-decoration: underline;"><a href="https://github.com/robbiehanson/CocoaLumberjack" target="_blank"><span style="color: #339966; text-decoration: underline;">Cocoa LumberJack</span></a> </span></span>– 这是针对Cocoa非常出名的一个日志框架。虽然刚开始用的时候会费劲点，但是它非常强大。</li>
<li><span style="text-decoration: underline; color: #339966;"><a href="https://www.assembla.com/wiki/show/snlog" target="_blank"><span style="color: #339966; text-decoration: underline;">SNLog</span></a></span> – NSLog的一个替代品。</li>
</ul>


<h2><strong><span style="color: #339966;">跟踪对象的生命周期</span></strong></h2>

<p>虽然ARC可以对内存进行有效的管理，不过在对象的生命周期内跟踪一些重要的事件仍然是重要的。毕竟ARC并不能完全消除内存泄露的可能性，或者确保访问的是一个被release掉的对象（ARC只是尽量避免这样的情况发生）。为此，我们可以使用一些方法和工具来观察并留意对象在做些什么。</p>

<h3><strong><span style="color: #339966;"> Log一些重要的事件</span></strong></h3>

<p>在一个Objective-C对象的生命周期中有两个重要的方法：init和dealloc。将这两个方法调用的事件log到控制台是不错的选择——你可以通过控制台观察到对象生命的开始，更重要的是，可以确保对象的释放。</p>

<pre class="wp-code-highlight prettyprint linenums:1">- (id)init
{
    self = [super init];
    if (self)
    {
        NSLog(@"%@: %@", NSStringFromSelector(_cmd), self);
    }
    return self;
}
- (void)dealloc
{
    NSLog(@"%@: %@", NSStringFromSelector(_cmd), self);
}</pre>


<h3><strong><span style="color: #339966;">静态分析器(Analyzer) 和检查器</span></strong></h3>

<p>在Xcode中有两个工具可以用来清理代码，以减少代码的错误率。静态分析器工具可以对我们的代码提出改进意见，比如检测出没有使用过的对象，没有release对象（针对Core Foundation对象，ARC仍然会有这样的问题）。通过选择Product菜单中的‘Anlayze’可以查看到相关建议。</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/analyse.png"><img class="alignnone size-full wp-image-633" alt="analyse" src="http://beyondvincent.com/wp-content/uploads/2013/05/analyse.png" width="987" height="115" /></a></p>

<p>&nbsp;</p>

<p>检查器是非常强大的一组工具，通过检查器不仅可以从不同的角度检查我们程序对内存的使用情况，文件系统的使用情况（增加、删除、修改等），甚至还提供了自动UI交互的方法。通过选择Product菜单中的‘Profile’可以查看到这些检查器。</p>

<p>选择‘Profile’会打开一个Instrument窗口，这里可以选择一个配置模板进行运行。最常用的模板有zombies（稍后会讨论），activity monitor和leaks。在程序运行时，对内存泄露进行捕捉时，Leaks可能是最有用的一个模板。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/Screen-Shot-2012-12-09-at-1.23.38-PM.png"><img class="alignnone size-full wp-image-634" alt="Screen-Shot-2012-12-09-at-1.23.38-PM" src="http://beyondvincent.com/wp-content/uploads/2013/05/Screen-Shot-2012-12-09-at-1.23.38-PM.png" width="513" height="193" /></a></p>

<p><strong style="font-size: 1.17em;"><span style="color: #339966;">Zombies是你的朋友</span></strong></p>

<p>虽然在有ARC的地方很难再遇到让人难受的EXC_BAD_ACCESS错误了，但是在某些确定的情况下，该错误还是会发生的。当在处理UIPopoverController或者core foundation对象时，我们可以访问一个已经被release掉的对象。一般，当我们release内存中的一个对象时，该对象将被销毁。但是，当Zombies开启时，只是将对象标记为release，实际上该对象还停留在内存中。当我们访问一个Zombie对象时，Xcode可以告诉我们正在访问的对象是一个不应该存在的对象了。因为Xcode知道这个对象是什么，所以可以让我们知道这个对象在哪里，以及这是什么时候发生的。</p>

<p>这里有两种方法可以查找出Zombies对象。使用检查器中的Zombie配置模板，或者在‘Run’ build选项中开启Zombie诊断选项。在Stop按钮的旁边，点击scheme名称，然后选择‘Edit Scheme’，点击diagnostic tab项，并勾选上‘Enable Zombie Objects’。注意，Zombie只能用在模拟器调试中，真机上不能使用。</p>

<p><a href="http://beyondvincent.com/wp-content/uploads/2013/05/Enabling-Zombies.png"><img class="alignnone size-full wp-image-635" alt="Enabling-Zombies" src="http://beyondvincent.com/wp-content/uploads/2013/05/Enabling-Zombies.png" width="613" height="227" /></a></p>

<h2><strong><span style="color: #339966;">结论</span></strong></h2>

<p>希望上面的这些关于调试技巧能给你带来帮助。通过上面的这些技巧，可以帮助你减少修改bug的时间，从而把更多的时间用在重要的地方——构建出色的程序！</p>

<p>上面列出来的不是一个完整的调试技巧。另外还有许多技术没有进行讨论，例如在真机中调试问题，远程bug报告，crash报告等。</p>

<p>祝编程愉快！</p>

<p>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_____</p>

<p>本文由破船译自：<span style="text-decoration: underline;"><span style="color: #339966;"><a href="http://mobile.tutsplus.com/tutorials/iphone/debugging-in-ios-essential-tips/" target="_blank"><span style="color: #339966; text-decoration: underline;">tutsplus</span></a></span></span><br/>
转载请注明出处：<span style="text-decoration: underline;"><span style="color: #339966;"><strong><a href="http://www.beyondvincent.com/" target="_blank"><span style="color: #339966; text-decoration: underline;">BeyondVincent的博客</span></a></strong></span></span><br/>
_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_<strong>_</strong>_____</p>

		
		
	</div>

</article>

</div>
<nav id="pagenavi">
    
        <a href="/blog/page/11/" class="prev">Prev</a>
    
    
        <a href="/blog/page/13/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">所有文章</a></div>
    
    <script type="text/javascript">
var duoshuoQuery = {short_name:"beyondvincent"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
</nav>

</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2014 - 破船(BeyondVincent) -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'beyondvincent001';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-42893468-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>





<script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F1a3c98825a726bfbf68a83ba97e0b9be' type='text/javascript'%3E%3C/script%3E"));
    </script>

		</div>
	</div>
</body>
</html>
